"0","myleague <- function(leagueId, table = ""no"") {"
"0","  base_url <- ""http://api.isportsapi.com/sport/football/standing/league?leagueId="""
"0","  call_url <- str_c(base_url, leagueId, ""&api_key="", Sys.getenv(""ISPORT_KEY""))"
"0","  message(""Calling http://api.isportsapi.com/sport/football/standing/league?leagueId="", leagueId, ""&api_key=YOUR_API_KEY"")"
"0","  "
"0","  req <- GET(call_url)"
"0","  message(http_status(req))"
"0","         "
"0","  if (req$status_code != 200) {"
"0","    stop (""Error when calling API. Response: "", content(req))"
"0","  }"
"0","  "
"0","  league_list <- fromJSON(toJSON(content(req)))"
"0","  "
"0","  if (table == ""yes"") {"
"0","    league_df <- as.data.frame(league_list$data[1]) %>%"
"0","    unnest(cols = c())"
"0","    "
"0","    league_df_final <- league_df %>% "
"0","      select(LeagueID = leagueInfo.leagueId, Name = leagueInfo.name, Abbreviation = leagueInfo.shortName, "
"0","             Total_Rounds = leagueInfo.totalRound, Current_Round = leagueInfo.currentRound, "
"0","             Current_Season = leagueInfo.currentSeason)"
"0","    "
"0","    team_info_df <- as.data.frame(league_list$data[3])"
"0","    team_info_df <- team_info_df %>%"
"0","      unnest(cols = c(teamInfos.teamId, teamInfos.name, teamInfos.logo, teamInfos.area)) %>%"
"0","      select(totalStandings.teamId = teamInfos.teamId, teamInfos.name)"
"0","    "
"0","    standings_df <- as.data.frame(league_list$data[4]) %>%"
"0","      unnest(cols = c(totalStandings.rank, totalStandings.teamId, totalStandings.winRate,"
"0","                      totalStandings.drawRate, totalStandings.loseRate, totalStandings.winAverage, "
"0","                      totalStandings.loseAverage, totalStandings.deduction, "
"0","                      totalStandings.deductionExplain, totalStandings.recentFirstResult, "
"0","                      totalStandings.recentSecondResult,"
"0","                      totalStandings.recentThirdResult, totalStandings.recentFourthResult,"
"0","                      totalStandings.recentFifthResult, totalStandings.recentSixthResult, "
"0","                      totalStandings.color, totalStandings.red, totalStandings.totalCount, "
"0","                      totalStandings.winCount, totalStandings.drawCount, totalStandings.loseCount, "
"0","                      totalStandings.getScore, totalStandings.loseScore, totalStandings.goalDifference, "
"0","                      totalStandings.integral))"
"0","    "
"0","    league_table <- left_join(standings_df, team_info_df, by = ""totalStandings.teamId"")"
"0","    "
"0","    league_table <- league_table %>%"
"0","      select(Rank = totalStandings.rank, Club = teamInfos.name, Matches_Played = totalStandings.totalCount, "
"0","             Points = totalStandings.integral, Wins = totalStandings.winCount, Losses = totalStandings.loseCount, "
"0","             Draws = totalStandings.drawCount, Goals_For = totalStandings.getScore, "
"0","             Goals_Against =totalStandings.loseScore, Goal_Diff = totalStandings.goalDifference)"
"0","    "
"0","    "
"0","    print(league_df_final)"
"0","    print(league_table)"
"0","    "
"0","    "
"0","  } else if (table == ""no"") {"
"0","    league_df <- as.data.frame(league_list$data[1]) %>%"
"0","    flatten() %>%"
"0","    unnest(cols = c())"
"0","    "
"0","    league_df_final <- league_df %>% "
"0","      select(LeagueID = leagueInfo.leagueId, Name = leagueInfo.name, Abbreviation = leagueInfo.shortName, "
"0","             Total_Rounds = leagueInfo.totalRound, Current_Round = leagueInfo.currentRound, "
"0","             Current_Season = leagueInfo.currentSeason)"
"0","    "
"0","    print(league_df_final)"
"0","  }"
"0","  "
"0","}"
"0",""
"0","myleague(1639, ""yes"")"
"2","Calling http://api.isportsapi.com/sport/football/standing/league?leagueId=1639&api_key=YOUR_API_KEY
"
"2","SuccessOKSuccess: (200) OK
"
